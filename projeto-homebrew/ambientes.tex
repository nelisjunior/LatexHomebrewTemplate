% Ambientes personalizados com tcolorbox para estilo RPG

% Configurações comuns para caixas RPG
\tcbset{
    common/.style={
        enhanced,
        frame hidden,
        interior hidden,
        colback=boxbg,
        colframe=boxborder,
        fonttitle=\bfseries\Large,
        coltitle=white,
        colbacktitle=boxborder,
        attach boxed title to top left={yshift=-2mm, xshift=5mm},
        boxed title style={sharp corners, frame hidden},
        underlay={\begin{tcbclipinterior}
            \draw[boxborder, line width=2pt] 
            (frame.south west) rectangle (frame.north east);
            \end{tcbclipinterior}},
        breakable,
        drop shadow=boxborder,
        before skip=0.5cm,
        after skip=0.5cm,
    }
}

% Estilo alternativo usando mdframed
\mdfdefinestyle{rpgstyle}{%
    linecolor=boxborder,
    linewidth=2pt,
    backgroundcolor=boxbg,
    roundcorner=5pt,
    shadow=true,
    shadowcolor=black!30,
}

% Ambiente para descrição de itens mágicos
\newtcolorbox{magicitem}[1][]{
    common,
    colbacktitle=magicitem,
    title=Item Mágico,
    #1
}

% Ambiente para feitiços
\newtcolorbox{spell}[1][]{
    common,
    colbacktitle=spell,
    title=Feitiço,
    #1
}

% Ambiente para personagens
\newtcolorbox{character}[1][]{
    common,
    colbacktitle=Brown!80!black,
    title=Personagem,
    #1
}

% Ambiente para notas do mestre
\newtcolorbox{dmnote}[1][]{
    common,
    colbacktitle=note,
    title=Nota do Mestre,
    #1
}

% Ambiente para regras
\newtcolorbox{rule}[1][]{
    common,
    colbacktitle=rule,
    title=Regra,
    #1
}

% Ambiente para tabelas
\newtcolorbox{rpgtable}[1][]{
    common,
    colbacktitle=Mahogany!70!black,
    title=Tabela,
    #1
}

% Ambiente para citações
\newtcolorbox{quotebox}[1][]{
    common,
    fonttitle=\itshape\large,
    colbacktitle=Gray!70!black,
    title=Citação,
    #1
}

% Ambiente para destaque
\newtcolorbox{highlight}[1][]{
    common,
    colbacktitle=Orange!70!black,
    title=Destaque,
    #1
}

% Comandos para estatísticas de personagem
\newcommand{\statnumber}[1]{%
    \begingroup
    \setlength{\fboxsep}{2pt}%
    \colorbox{boxbg}{\textbf{#1}}%
    \endgroup
}

\newcommand{\stat}[2]{%
    \textbf{#1} \statnumber{#2}%
}

% Comando para criar barras de atributos
\newcommand{\attrbar}[2]{%
    \begingroup
    \setlength{\unitlength}{1mm}%
    \begin{picture}(30,5)%
    \put(0,0){\color{boxborder}\rule{30mm}{5mm}}%
    \put(0,0){\color{secaotitulo}\rule{#2mm}{5mm}}%
    \put(15,2.5){\makebox(0,0)[c]{\textcolor{white}{\textbf{#1}}}}%
    \end{picture}%
    \endgroup
}

% Comando para criar listas de itens estilizadas
\newcommand{\rpgitem}[1]{%
    \item[\textcolor{secaotitulo}{\small\ding{108}}] #1
}

% Comando para titulos estilizados
\newcommand{\rpgtitle}[1]{%
    \begin{center}
        \begingroup
        \setlength{\fboxsep}{5pt}%
        \colorbox{capa}{\textcolor{white}{\Large\bfseries #1}}%
        \endgroup
    \end{center}
}

% Comando para notas de margem (anotações)
\newcommand{\rpgnote}[1]{%
    \marginpar{%
        \begin{mdframed}[style=rpgstyle]
        {\small\itshape #1}
        \end{mdframed}%
    }%
}

% Comando para adição de glossário
\newcommand{\glossaryentry}[2]{%
    \newglossaryentry{#1}{%
        name=#1,%
        description={#2}%
    }%
}

% Comando para encabezamento de seção RPG
\newcommand{\rpgsection}[1]{%
    \vspace{0.5cm}
    \begin{center}
        \begin{tikzpicture}
            \node[draw=boxborder, fill=boxbg, line width=2pt, inner sep=8pt] 
                 {\large\bfseries\color{secaotitulo} #1};
        \end{tikzpicture}
    \end{center}
    \vspace{0.3cm}
}

% Importação dos ambientes para mapa mental de estrutura do documento
\input{ambientes/docmap}
\input{ambientes/auto-docmap}
